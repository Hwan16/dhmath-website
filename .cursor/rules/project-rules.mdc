---
alwaysApply: true
---

# 김다희 수학 강사 웹사이트 - 프로젝트 규칙

## 프로젝트 개요
고등 수학강사 '김다희'의 개인 브랜딩 웹사이트입니다. 학생들이 실질적으로 이용할 수 있는 기능(강의 수강, 아티클 열람 등)을 제공합니다.

## 기술 스택
- **프레임워크**: Next.js 14 (App Router)
- **언어**: TypeScript
- **스타일링**: Tailwind CSS
- **백엔드/DB**: Supabase (Auth, PostgreSQL)
- **CMS**: Sanity
- **영상**: YouTube 임베드
- **달력**: FullCalendar
- **배포**: Vercel

## 핵심 원칙

### 1. 반응형 필수
- 모든 페이지와 컴포넌트는 반드시 PC와 모바일 모두에서 정상 동작해야 함
- Tailwind의 반응형 클래스를 적극 활용 (sm:, md:, lg:, xl:)
- 모바일 퍼스트로 작성 후 데스크톱 스타일 추가

### 2. 디자인 톤
- 밝고 따뜻한 느낌
- 메인 컬러: 핑크 (#FF8FAB), 살구/피치 (#FFD4A3)
- 배경: 따뜻한 화이트 (#FFFAF5)
- 둥근 모서리, 부드러운 그림자, 넉넉한 여백

### 3. 코드 스타일
- 컴포넌트는 함수형으로 작성
- TypeScript 타입을 명확하게 정의
- 주석은 한글로 작성
- 파일명은 케밥케이스 (예: lecture-card.tsx)
- 컴포넌트명은 파스칼케이스 (예: LectureCard)

## 폴더 구조
```
src/
├── app/                    # Next.js App Router 페이지
│   ├── (public)/          # 공개 페이지 그룹
│   ├── (auth)/            # 인증 관련 페이지
│   ├── (protected)/       # 로그인 필요 페이지
│   └── admin/             # 관리자 페이지
├── components/
│   ├── ui/                # 재사용 가능한 UI 컴포넌트
│   ├── layout/            # 레이아웃 컴포넌트 (Header, Footer 등)
│   └── features/          # 기능별 컴포넌트
├── lib/
│   ├── supabase/          # Supabase 클라이언트 및 유틸
│   └── sanity/            # Sanity 클라이언트 및 쿼리
├── types/                 # TypeScript 타입 정의
└── styles/                # 전역 스타일
```

## Supabase 관련
- 클라이언트는 `lib/supabase/client.ts`에서 싱글톤으로 관리
- 서버 컴포넌트에서는 `createServerComponentClient` 사용
- RLS(Row Level Security) 정책을 반드시 설정
- 환경 변수: `NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`

## Sanity 관련
- 스키마는 `sanity/schemas/` 폴더에 정의
- 쿼리는 GROQ 사용
- 이미지는 `@sanity/image-url` 패키지로 URL 생성
- 환경 변수: `NEXT_PUBLIC_SANITY_PROJECT_ID`, `NEXT_PUBLIC_SANITY_DATASET`

## 컴포넌트 작성 규칙

### 재사용 컴포넌트
```tsx
// components/ui/button.tsx
interface ButtonProps {
  variant?: 'primary' | 'secondary' | 'outline';
  size?: 'sm' | 'md' | 'lg';
  children: React.ReactNode;
  onClick?: () => void;
  disabled?: boolean;
  className?: string;
}

export function Button({ variant = 'primary', size = 'md', ...props }: ButtonProps) {
  // 구현
}
```

### 페이지 컴포넌트
```tsx
// app/articles/page.tsx
export default async function ArticlesPage() {
  // 서버에서 데이터 페칭
  const articles = await getArticles();
  
  return (
    <main className="container mx-auto px-4 py-8">
      {/* 페이지 내용 */}
    </main>
  );
}
```

## 인증 및 권한

### 권한 레벨
- `guest`: 비로그인 사용자 - 공개 페이지만 접근
- `student`: 일반 학생 - 허용된 강의만 시청
- `admin`: 관리자 - 모든 기능 접근

### 보호된 페이지
```tsx
// 미들웨어 또는 레이아웃에서 인증 체크
import { createServerComponentClient } from '@supabase/auth-helpers-nextjs';
import { redirect } from 'next/navigation';

export default async function ProtectedLayout({ children }) {
  const supabase = createServerComponentClient({ cookies });
  const { data: { session } } = await supabase.auth.getSession();
  
  if (!session) {
    redirect('/auth/login');
  }
  
  return children;
}
```

## YouTube 임베드
```tsx
// 추천 영상 비활성화, 브랜딩 최소화
<iframe
  src={`https://www.youtube.com/embed/${videoId}?rel=0&modestbranding=1`}
  className="w-full aspect-video rounded-lg"
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
  allowFullScreen
/>
```

## 에러 처리
- 모든 비동기 작업에 try-catch 사용
- 사용자 친화적인 에러 메시지 표시
- 에러 바운더리 컴포넌트 활용

## 성능 최적화
- 이미지는 Next.js Image 컴포넌트 사용
- 동적 import로 코드 스플리팅
- Sanity 이미지는 적절한 크기로 리사이징
